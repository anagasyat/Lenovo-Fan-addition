import ctypes
import sys
from ctypes import wintypes
import pystray
from PIL import Image
import base64
import io
import time

# 定义风扇模式
class FanMode:
    NORMAL = 0
    FAST = 1

# 打开设备驱动的函数
def create_file(lp_filename):
    kernel32 = ctypes.WinDLL('kernel32', use_last_error=True)
    return kernel32.CreateFileW(
        lp_filename,
        wintypes.DWORD(0x40000000),  # GENERIC_WRITE
        wintypes.DWORD(0),
        None,
        wintypes.DWORD(3),  # OPEN_EXISTING
        wintypes.DWORD(0x80),  # FILE_ATTRIBUTE_NORMAL
        None
    )

# DeviceIoControl 的包装函数
def device_io_control(h_device, io_control_code, lp_in_buffer, lp_out_buffer):
    kernel32 = ctypes.WinDLL('kernel32', use_last_error=True)
    bytes_returned = wintypes.DWORD()
    if lp_out_buffer is None:
        # 如果不需要输出缓冲区，传递一个空的 ctypes 数组
        lp_out_buffer = (wintypes.DWORD * 0)()
    success = kernel32.DeviceIoControl(
        h_device,
        io_control_code,
        ctypes.byref(lp_in_buffer) if lp_in_buffer is not None else None,
        ctypes.sizeof(lp_in_buffer) if lp_in_buffer is not None else 0,
        ctypes.byref(lp_out_buffer) if lp_out_buffer is not None else None,
        ctypes.sizeof(lp_out_buffer) if lp_out_buffer is not None else 0,
        ctypes.byref(bytes_returned),
        None
    )
    return success, bytes_returned.value

# 设置风扇模式
def fan_control(mode):
    hndl = create_file(r"\\.\EnergyDrv")
    if hndl == -1:  # INVALID_HANDLE_VALUE
        return -1

    # 输入缓冲区
    in_buffer = (wintypes.DWORD * 3)(6, 1, mode)
    # 调用 DeviceIoControl
    success, _ = device_io_control(
        hndl,
        0x831020C0,  # IOCTL_CODE
        in_buffer,
        None  # 不需要输出缓冲区
    )
    ctypes.windll.kernel32.CloseHandle(hndl)
    return 1 if success else -1

# 创建托盘图标
def create_icon():
    try:
        # 此处预留图标数据，你可以替换为实际的 Base64 编码图标数据
        image_data = base64.b64decode(b'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1z8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh3YhAYe2P8GHtj/Bh7Y/wYe2P8GHtmGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGHthUBh7Y/wYe2P8GHtj/Bh7XrAAAvwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQe2DsGHtj/Bh7Y/wYe16EAANQGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB7UPAYe1+cFHddgAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG9cTABfRCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAAAABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABrMCgQf2EIAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa5goAFdQYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAg3wgIHtZEBh3XywMe2FYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAc1RIFHteSBhzXWgAk2w4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB/gGQYe2IgGHtfnBh7Y1wAa5goAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wIFHthvBh7Y8QYe1qMFGtUxAAD/AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFG9kvBx7ZwQYe2PoGHtj/BR3XjQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEH9c5Bh7Y5wYe2fwGHtnUBB3WPgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAgQf2zkGHtjTBh7Y/wYe2P8GHtj+BhvYVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHNUSBh7Z1AYe2P8GHtj/BR7Y8wYd11kAJNsHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAx7XTAYe2dwGHtj/Bh7Y/wYe2P8FHtj5BR3YNAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIACBh3XsQYe2P8GHtj/Bh7Y/wYe2OwFHdZrACTbBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFG9s4Bh7Y2gYe2P8GHtj/Bh7Y/wYe2P8FHtn3BhzYLgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh7YiAYe2P8GHtj/Bh7Y/wYe2P8FHdjrAxvXTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa2RQGHtezBh7Z/gYe2P8GHtj/Bh7Y/wYe2P8GHtj8BB7UOwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR3baQYe2P8GHtj/Bh7Y/wYe2P8GHtj/BR7Y6QYd3CwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUe12YGHtj4Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj+BR3YaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR3YYQYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUd2L8AG9scAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABzjCQYe2NwGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh3YtgAA/wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR/WZAYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2PgEHNh1AAC/BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh3WUAYe2P4GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7X+QAc2C4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB/XcwYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtjNCRrcHQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR3XlAYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYd164AIt0PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR7YkAYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHdf7BR3XYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKoDBR/XwAYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2PIFHddgAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8CBh3YtgYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/BR7YwgAA/wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHMYJBR3Y0QYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GH9nICCLdHgAAAAAAAAAAADP/BQAk2wcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANGtkUBh7Z1wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y+QAb2xwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHOMJBR3X0gYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj8Bh7XgQAAAAAAAAAAABjOFQUe1nAAAMwFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEHtg7BR7X6AYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wMd2VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8DBR7YwwYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y7wcd0yMAAAAAAAC/CAUe2N0EHdo+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEFH9lsBh7Y+AYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wQe1ncAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR7XoQYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUe2JAAAIACABDPEAUe2PgFHdiVABzGCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAn2A0GH9mmBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUd2ZMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR3WagYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2dcAG9scBBvYQQYe2P4GHtjeByHYJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYc2C4GHtjkBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUe2JgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABjXIAYe2PkGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2O8GHdhPBR3YlQYe2P8GHtj9BR7YbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUc15IGHtj+Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYd2IsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AQYf2LcGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2PwFHtiqBh3Z4gYe2P8GHtj/BR7XwQAA/wEAAAAAAAAAAAAAAAAAAAAABR/WMgUe2PUGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wQf2nQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYd2E8GHtj2Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj5Bh7Y/QYe2P8GHtj/Bh3Y8wAc1RIAAAAAAAAAAAAAAAAAFtMXBR7ZugYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wQc1UgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAh0xcFHti+Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Z/gkf1zoAAAAAAAAAAAAzzAUGHdd6Bh7Z9wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/BR7Y+AAX0RYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wIFHNdtBh7Y9wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUb1l4AAAAAAAD/AQQe1UMHHtfoBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/BR7YxAAA/wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH9ghBh7X1QYe2P8GHtj/Bh7Y/wUd2OsGHtn9Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wQd13MAAP8CBB3bRwYe2dsGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj9BR3WagAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BBh7YdgYe2P8GHtj/Bh7Y/wUd2JYGHdfHBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wQe13gGH9dSBh3X4QYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtjkBhrSKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABLbDgYe2OAGHtj/Bh7Y/wUe3F4HG9pMBR7Y6QYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYd17EGHtjsBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P4FHdieABXUDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcd2XMGHtj9Bh7Y/gUb1jgAAMwFBh/YfQYe2P0GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2f0GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe1+4GHdhPAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYa2SgGHtjjBR7Y9AAR3Q8AAAAAABfRCwYd2LYGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/BR3Y6gYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUe17oAFdQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAe0hEGHteyBh7YuQAA/wEAAAAAAAAAAAYd1iwGHdfhBh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj4BxzZSQce2LwGHtj/Bh7Y/wYe2P8GHtj/Bh7X9AUb1jgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAzzAUGHdiDBh7YVAAAAAAAAAAAAAAAAAAk2wcGHdZ9Bh7Z9wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtjTCRrcHQQb2EIGHdjzBh7Y/wYe2P8GHtj6Bh3XhQAA/wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEFHNU3ABrMFAAAAAAAAAAAAAAAAAAAAAAAHNAbBR/Y0QYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P4HHtibABrMCgkc2RsGHtfOBh7Y/wYe2P8FHtm9AB3YGgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh/YWwYe2PwGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2PIGHNpaAAAAAAAb1xMGHdi5Bh7Y/wYe2OYHHNlJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDfCAUe2boGHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYd2NAAG9EcAAAAAAAa2RQFHde7Bh7Y9wUf2WwAAP8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQe2kQGHtn2Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wUd1nEAAP8BAAAAAAAc2RsFHtjLBB3XegAq1AYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY2xUFHti9Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7X1AAX6AsAAAAAAAAAAAca0ScGHtl+ABfoCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwQGHtl4Bh7Y+QYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2P8GHtnwBhzXUgAAAAAAAAAAAAAAAAAX0RYAHtIRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEHdU9BR7Z6AYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2f0GHdieABTYDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHuERBh7Z1AYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bh7Y/wYe2NcGHNguAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIACBh3YrwYe2P8GHtj/Bh7Y/wYe2P8GHtj/Bx7X6Acd2E4AAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh7XgAYe2P8GHtj/Bh7Y/wYe2P8GHtjsBhzXUgAA/wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR7ZZQYe2P8GHtj/Bh7Y/wYe2OUFHtleAAD/AwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABRvWXQYe2P8GHdf7BR7Ywgcb1ksAAL8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABR3YaAYe1+4EHdZ9ABzZGwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABRzZNggZ1h8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==')
        image = Image.open(io.BytesIO(image_data))
        return image
    except Exception as e:
        print(f"图标创建失败: {e}")
        return None

# 显示托盘通知
def show_tray_notification(icon, title, message):
    try:
        icon.notify(title, message)
    except Exception as e:
        print(f"通知发送失败: {e}")

# 菜单选项：全速风力
def set_fast_mode(icon, item):
    result = fan_control(FanMode.FAST)
    if result == 1:
        message = "风扇已设置为全速模式"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)
    else:
        message = "设置全速模式失败，请检查管理员权限或设备驱动"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)

# 菜单选项：正常风力
def set_normal_mode(icon, item):
    result = fan_control(FanMode.NORMAL)
    if result == 1:
        message = "风扇已设置为正常模式"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)
    else:
        message = "设置正常模式失败，请检查管理员权限或设备驱动"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)

# 检查是否以管理员权限运行
def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin() == 1
    except:
        return False

# 请求管理员权限
def request_admin_rights():
    if not is_admin():
        # 重新启动脚本并请求管理员权限
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            " ".join(sys.argv),
            None,
            1  # SW_SHOWNORMAL
        )
        sys.exit(0)

# 退出程序并改回正常模式
def exit_program(icon):
    result = fan_control(FanMode.NORMAL)
    if result == 1:
        message = "程序退出，风扇已设置为正常模式"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)
    else:
        message = "程序退出，设置正常模式失败，请检查管理员权限或设备驱动"
        print(message)
        show_tray_notification(icon, "联想散热控制组件", message)
    icon.stop()

# 创建托盘图标和菜单
def main():
    # 请求管理员权限
    request_admin_rights()

    # 创建托盘图标
    icon = pystray.Icon(
        "fan_control",
        create_icon(),
        "联想散热控制组件",
        menu=pystray.Menu(
            pystray.MenuItem("全速风力", set_fast_mode),
            pystray.MenuItem("正常风力", set_normal_mode),
            pystray.MenuItem("退出程序", lambda icon: exit_program(icon))
        )
    )
 
    # 运行托盘图标
    icon.run()

if __name__ == "__main__":
    main()